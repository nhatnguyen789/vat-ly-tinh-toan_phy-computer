% x''=(2t/1+t^2)x' - (2/1+t^2)x +1
%t=[0:0.2:4]  x(0)=1.25  x(4)=0.95
clear all
hamu=@(t,p)([p(2);(2*t./(t.^2+1))*p(2)-(2/(t.^2+1))*p(1)+1]);
[t, p]=ode45(hamu,0.2:0.2:3.8,[1.25 0]);
[t p(:,1),p(:,2)]
hamv=@(t,z)([z(2);(2*t./(t.^2+1))*z(2)-(2/(t.^2+1))*z(1)]);
[t z]=ode45(hamv,0.2:0.2:3.8,[0 1]);
[t z(:,1),z(:,2)]

t=0.2:0.2:3.8;
n=length(t);
c=(-0.95-p(n,1))/z(n,1)
KQ=p(:,1)+c.*z(:,1)

[t' KQ]
figure(1)
plot(t,KQ)